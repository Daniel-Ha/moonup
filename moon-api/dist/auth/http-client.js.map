{"version":3,"sources":["../../src/auth/http-client.ts"],"sourcesContent":["/* eslint-disable */\n/* tslint:disable */\n/*\n * ---------------------------------------------------------------\n * ## THIS FILE WAS GENERATED VIA SWAGGER-TYPESCRIPT-API        ##\n * ##                                                           ##\n * ## AUTHOR: acacode                                           ##\n * ## SOURCE: https://github.com/acacode/swagger-typescript-api ##\n * ---------------------------------------------------------------\n */\n\nexport type QueryParamsType = Record<string | number, any>;\nexport type ResponseFormat = keyof Omit<Body, \"body\" | \"bodyUsed\">;\n\nexport interface FullRequestParams extends Omit<RequestInit, \"body\"> {\n  /** set parameter to `true` for call `securityWorker` for this request */\n  secure?: boolean;\n  /** request path */\n  path: string;\n  /** content type of request body */\n  type?: ContentType;\n  /** query params */\n  query?: QueryParamsType;\n  /** format of response (i.e. response.json() -> format: \"json\") */\n  format?: ResponseFormat;\n  /** request body */\n  body?: unknown;\n  /** base url */\n  baseUrl?: string;\n  /** request cancellation token */\n  cancelToken?: CancelToken;\n}\n\nexport type RequestParams = Omit<FullRequestParams, \"body\" | \"method\" | \"query\" | \"path\">;\n\nexport interface ApiConfig<SecurityDataType = unknown> {\n  baseUrl?: string;\n  baseApiParams?: Omit<RequestParams, \"baseUrl\" | \"cancelToken\" | \"signal\">;\n  securityWorker?: (securityData: SecurityDataType | null) => Promise<RequestParams | void> | RequestParams | void;\n  customFetch?: typeof fetch;\n}\n\nexport interface HttpResponse<D extends unknown, E extends unknown = unknown> extends Response {\n  data: D;\n  error: E;\n}\n\ntype CancelToken = Symbol | string | number;\n\nexport enum ContentType {\n  Json = \"application/json\",\n  FormData = \"multipart/form-data\",\n  UrlEncoded = \"application/x-www-form-urlencoded\",\n  Text = \"text/plain\",\n}\n\nexport class HttpClient<SecurityDataType = unknown> {\n  public baseUrl: string = \"https://vault-api.usemoon.ai/\";\n  private securityData: SecurityDataType | null = null;\n  private securityWorker?: ApiConfig<SecurityDataType>[\"securityWorker\"];\n  private abortControllers = new Map<CancelToken, AbortController>();\n  private customFetch = (...fetchParams: Parameters<typeof fetch>) => fetch(...fetchParams);\n\n  private baseApiParams: RequestParams = {\n    credentials: \"same-origin\",\n    headers: {},\n    redirect: \"follow\",\n    referrerPolicy: \"no-referrer\",\n  };\n\n  constructor(apiConfig: ApiConfig<SecurityDataType> = {}) {\n    Object.assign(this, apiConfig);\n  }\n\n  public setSecurityData = (data: SecurityDataType | null) => {\n    this.securityData = data;\n  };\n\n  protected encodeQueryParam(key: string, value: any) {\n    const encodedKey = encodeURIComponent(key);\n    return `${encodedKey}=${encodeURIComponent(typeof value === \"number\" ? value : `${value}`)}`;\n  }\n\n  protected addQueryParam(query: QueryParamsType, key: string) {\n    return this.encodeQueryParam(key, query[key]);\n  }\n\n  protected addArrayQueryParam(query: QueryParamsType, key: string) {\n    const value = query[key];\n    return value.map((v: any) => this.encodeQueryParam(key, v)).join(\"&\");\n  }\n\n  protected toQueryString(rawQuery?: QueryParamsType): string {\n    const query = rawQuery || {};\n    const keys = Object.keys(query).filter((key) => \"undefined\" !== typeof query[key]);\n    return keys\n      .map((key) => (Array.isArray(query[key]) ? this.addArrayQueryParam(query, key) : this.addQueryParam(query, key)))\n      .join(\"&\");\n  }\n\n  protected addQueryParams(rawQuery?: QueryParamsType): string {\n    const queryString = this.toQueryString(rawQuery);\n    return queryString ? `?${queryString}` : \"\";\n  }\n\n  private contentFormatters: Record<ContentType, (input: any) => any> = {\n    [ContentType.Json]: (input: any) =>\n      input !== null && (typeof input === \"object\" || typeof input === \"string\") ? JSON.stringify(input) : input,\n    [ContentType.Text]: (input: any) => (input !== null && typeof input !== \"string\" ? JSON.stringify(input) : input),\n    [ContentType.FormData]: (input: any) =>\n      Object.keys(input || {}).reduce((formData, key) => {\n        const property = input[key];\n        formData.append(\n          key,\n          property instanceof Blob\n            ? property\n            : typeof property === \"object\" && property !== null\n            ? JSON.stringify(property)\n            : `${property}`,\n        );\n        return formData;\n      }, new FormData()),\n    [ContentType.UrlEncoded]: (input: any) => this.toQueryString(input),\n  };\n\n  protected mergeRequestParams(params1: RequestParams, params2?: RequestParams): RequestParams {\n    return {\n      ...this.baseApiParams,\n      ...params1,\n      ...(params2 || {}),\n      headers: {\n        ...(this.baseApiParams.headers || {}),\n        ...(params1.headers || {}),\n        ...((params2 && params2.headers) || {}),\n      },\n    };\n  }\n\n  protected createAbortSignal = (cancelToken: CancelToken): AbortSignal | undefined => {\n    if (this.abortControllers.has(cancelToken)) {\n      const abortController = this.abortControllers.get(cancelToken);\n      if (abortController) {\n        return abortController.signal;\n      }\n      return void 0;\n    }\n\n    const abortController = new AbortController();\n    this.abortControllers.set(cancelToken, abortController);\n    return abortController.signal;\n  };\n\n  public abortRequest = (cancelToken: CancelToken) => {\n    const abortController = this.abortControllers.get(cancelToken);\n\n    if (abortController) {\n      abortController.abort();\n      this.abortControllers.delete(cancelToken);\n    }\n  };\n\n  public request = async <T = any, E = any>({\n    body,\n    secure,\n    path,\n    type,\n    query,\n    format,\n    baseUrl,\n    cancelToken,\n    ...params\n  }: FullRequestParams): Promise<HttpResponse<T, E>> => {\n    const secureParams =\n      ((typeof secure === \"boolean\" ? secure : this.baseApiParams.secure) &&\n        this.securityWorker &&\n        (await this.securityWorker(this.securityData))) ||\n      {};\n    const requestParams = this.mergeRequestParams(params, secureParams);\n    const queryString = query && this.toQueryString(query);\n    const payloadFormatter = this.contentFormatters[type || ContentType.Json];\n    const responseFormat = format || requestParams.format;\n\n    return this.customFetch(`${baseUrl || this.baseUrl || \"\"}${path}${queryString ? `?${queryString}` : \"\"}`, {\n      ...requestParams,\n      headers: {\n        ...(requestParams.headers || {}),\n        ...(type && type !== ContentType.FormData ? { \"Content-Type\": type } : {}),\n      },\n      signal: (cancelToken ? this.createAbortSignal(cancelToken) : requestParams.signal) || null,\n      body: typeof body === \"undefined\" || body === null ? null : payloadFormatter(body),\n    }).then(async (response) => {\n      const r = response as HttpResponse<T, E>;\n      r.data = null as unknown as T;\n      r.error = null as unknown as E;\n\n      const data = !responseFormat\n        ? r\n        : await response[responseFormat]()\n            .then((data) => {\n              if (r.ok) {\n                r.data = data;\n              } else {\n                r.error = data;\n              }\n              return r;\n            })\n            .catch((e) => {\n              r.error = e;\n              return r;\n            });\n\n      if (cancelToken) {\n        this.abortControllers.delete(cancelToken);\n      }\n\n      if (!response.ok) throw data;\n      return data;\n    });\n  };\n}\n"],"mappings":"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","names":["http_client_exports","__export","ContentType","HttpClient","__toCommonJS","apiConfig","fetchParams","data","input","formData","key","property","cancelToken","abortController","body","secure","path","type","query","format","baseUrl","params","secureParams","requestParams","queryString","payloadFormatter","responseFormat","response","r","e","value","v","rawQuery","params1","params2"]}