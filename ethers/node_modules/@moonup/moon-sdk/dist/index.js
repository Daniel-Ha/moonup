"use strict";var c=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var K=Object.getOwnPropertyNames;var g=Object.prototype.hasOwnProperty;var l=(a,t)=>{for(var n in t)c(a,n,{get:t[n],enumerable:!0})},A=(a,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of K(t))!g.call(a,i)&&i!==n&&c(a,i,{get:()=>t[i],enumerable:!(s=p(t,i))||s.enumerable});return a};var E=a=>A(c({},"__esModule",{value:!0}),a);var w={};l(w,{MoonSDK:()=>u});module.exports=E(w);var S=require("@ethersproject/bytes"),D=require("@ethersproject/hash"),e=require("@moonup/moon-api"),h=require("@supabase/supabase-js"),u=class{constructor(){this.isAuthenticated=!1;let t={baseUrl:"https://moon-vault-api-git-ew-supabase-migration-moonup.vercel.app",baseApiParams:{secure:!0,type:e.ContentType.Json,format:"json"},securityWorker:async n=>Promise.resolve({headers:{Authorization:`Bearer ${n.token}`}})};this.AccountsSDK=new e.Accounts(t),this.AuthSDK=new e.Auth(t),this.AaveSDK=new e.Aave(t),this.ENSSDK=new e.Ens(t),this.Erc20SDK=new e.Erc20(t),this.Erc1155SDK=new e.Erc1155(t),this.Erc721SDK=new e.Erc721(t),this.Erc4337SDK=new e.Erc4337(t),this.OneinchSDK=new e.Oneinch(t),this.UniswapSDK=new e.Uniswap(t),this.YearnSDK=new e.Yearn(t),this.ConveyorfinanceSDK=new e.Conveyorfinance(t),this.BitcoinSDK=new e.Bitcoin(t),this.BitcoincashSDK=new e.Bitcoincash(t),this.DogecoinSDK=new e.Dogecoin(t),this.SolanaSDK=new e.Solana(t),this.CosmosSDK=new e.Cosmos(t),this.EosSDK=new e.Eos(t),this.LitecoinSDK=new e.Litecoin(t),this.RippleSDK=new e.Ripple(t),this.TronSDK=new e.Tron(t),this.MoonAPIClient=(0,h.createClient)("https://api.usemoon.ai","",{}),this.connect()}async connect(){this.MoonAPIClient.auth.onAuthStateChange((s,i)=>{s==="SIGNED_IN"&&(this.setAccessToken(i?.access_token||"",i?.refresh_token||""),this.isAuthenticated=!0),s==="TOKEN_REFRESHED"&&(this.setAccessToken(i?.access_token||"",i?.refresh_token||""),this.isAuthenticated=!0),s==="SIGNED_OUT"&&(this.updateToken(""),this.isAuthenticated=!1)});let{data:t,error:n}=await this.MoonAPIClient.auth.getSession();t&&(this.setAccessToken(t.session?.access_token||"",t.session?.refresh_token||""),this.isAuthenticated=!0),n&&(this.isAuthenticated=!1)}async disconnect(){this.MoonAPIClient.auth.signOut(),this.updateToken(""),this.isAuthenticated=!1}async getUserSession(){return await this.MoonAPIClient.auth.getSession()}async setAccessToken(t,n){return this.updateToken(t),await this.MoonAPIClient.auth.setSession({access_token:t,refresh_token:n})}getSolanaSDK(){return this.SolanaSDK}getBitcoinSDK(){return this.BitcoinSDK}getCosmosSDK(){return this.CosmosSDK}getEosSDK(){return this.EosSDK}getLitecoinSDK(){return this.LitecoinSDK}getRippleSDK(){return this.RippleSDK}getTronSDK(){return this.TronSDK}getBitcoincashSDK(){return this.BitcoincashSDK}getDogecoinSDK(){return this.DogecoinSDK}getAuthSDK(){return this.AuthSDK}getAccountsSDK(){return this.AccountsSDK}getAaveSDK(){return this.AaveSDK}getConveyorfinanceSDK(){return this.ConveyorfinanceSDK}getENSSDK(){return this.ENSSDK}getErc20SDK(){return this.Erc20SDK}getErc1155SDK(){return this.Erc1155SDK}getErc721SDK(){return this.Erc721SDK}getErc4337SDK(){return this.Erc4337SDK}getOneinchSDK(){return this.OneinchSDK}getUniswapSDK(){return this.UniswapSDK}getYearnSDK(){return this.YearnSDK}updateToken(t){this.BitcoinSDK.setSecurityData({token:t}),this.AccountsSDK.setSecurityData({token:t}),this.AaveSDK.setSecurityData({token:t}),this.ConveyorfinanceSDK.setSecurityData({token:t}),this.ENSSDK.setSecurityData({token:t}),this.Erc20SDK.setSecurityData({token:t}),this.Erc1155SDK.setSecurityData({token:t}),this.Erc721SDK.setSecurityData({token:t}),this.Erc4337SDK.setSecurityData({token:t}),this.OneinchSDK.setSecurityData({token:t}),this.UniswapSDK.setSecurityData({token:t}),this.SolanaSDK.setSecurityData({token:t}),this.CosmosSDK.setSecurityData({token:t}),this.EosSDK.setSecurityData({token:t}),this.LitecoinSDK.setSecurityData({token:t}),this.RippleSDK.setSecurityData({token:t}),this.TronSDK.setSecurityData({token:t}),this.BitcoincashSDK.setSecurityData({token:t}),this.DogecoinSDK.setSecurityData({token:t})}async listAccounts(){let t=await this.getAccountsSDK().listAccounts();if(!t.ok)throw new Error(t.statusText);return t.data}async createAccount(){let t=await this.getAccountsSDK().createAccount({});if(!t.ok)throw new Error(t.statusText);return t.data}moonTransactionResponseToTransactions(t){return t.transactions||[]}async SignTransaction(t,n){return await this.getAccountsSDK().signTransaction(t,n).then(i=>{if(!i.ok)throw new Error(i.statusText);return this.moonTransactionResponseToTransactions(i.data.data)?.at(0)?.raw_transaction})||""}async SignMessage(t,n){let s=new Uint8Array((0,S.arrayify)((0,D.hashMessage)(n)));return(await this.getAccountsSDK().signMessage(t,{data:s.toString(),encoding:"utf-8"}).then(r=>{if(!r.ok)throw new Error(r.statusText);return r.data.data})).signed_message||""}async SignTypedData(t,n,s,i){return(await this.getAccountsSDK().signTypedData(t,{data:JSON.stringify({domain:n,types:s,value:i})}).then(o=>{if(!o.ok)throw new Error(o.statusText);return o.data.data})).signed_message||""}async SendTransaction(t,n,s){let i=await this.getAccountsSDK().broadcastTx(t,{rawTransaction:n,chainId:s});if(!i.ok)throw new Error(i.statusText);return i.data.data}};0&&(module.exports={MoonSDK});
//# sourceMappingURL=index.js.map